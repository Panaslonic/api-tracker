# –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ API Watcher

## –¢–∏–ø—ã –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫

### 1. –û—à–∏–±–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

#### Timeout (‚è±Ô∏è)
- **–ü—Ä–∏—á–∏–Ω–∞**: –°–µ—Ä–≤–µ—Ä –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –≤ —Ç–µ—á–µ–Ω–∏–µ 30 —Å–µ–∫—É–Ω–¥
- **–û–±—Ä–∞–±–æ—Ç–∫–∞**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π retry —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π (1—Å, 2—Å, 4—Å)
- **–ü—Ä–∏–º–µ—Ä**: `Timeout –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫ https://example.com`

#### ConnectionError (üîå)
- **–ü—Ä–∏—á–∏–Ω–∞**: –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å —Å–µ—Ä–≤–µ—Ä–æ–º
- **–û–±—Ä–∞–±–æ—Ç–∫–∞**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π retry
- **–ü—Ä–∏–º–µ—Ä—ã**:
  - DNS –Ω–µ —Ä–∞–∑—Ä–µ—à–∞–µ—Ç—Å—è
  - –°–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
  - –ü—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ç—å—é

### 2. HTTP –æ—à–∏–±–∫–∏

#### 401 Unauthorized (üîí)
- **–ü—Ä–∏—á–∏–Ω–∞**: –¢—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- **–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ API –∫–ª—é—á–∏ –∏ —Ç–æ–∫–µ–Ω—ã –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

#### 403 Forbidden (üîí)
- **–ü—Ä–∏—á–∏–Ω–∞**: –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω
- **–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ API

#### 404 Not Found
- **–ü—Ä–∏—á–∏–Ω–∞**: –†–µ—Å—É—Ä—Å –Ω–µ –Ω–∞–π–¥–µ–Ω
- **–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å URL

#### 5xx Server Error
- **–ü—Ä–∏—á–∏–Ω–∞**: –û—à–∏–±–∫–∞ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞
- **–û–±—Ä–∞–±–æ—Ç–∫–∞**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π retry

### 3. –û—à–∏–±–∫–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞

#### JSONDecodeError (üìù)
- **–ü—Ä–∏—á–∏–Ω–∞**: –°–µ—Ä–≤–µ—Ä –≤–µ—Ä–Ω—É–ª –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π JSON –∏–ª–∏ HTML –≤–º–µ—Å—Ç–æ JSON
- **–°–æ–æ–±—â–µ–Ω–∏–µ**: `–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON: ... –í–æ–∑–º–æ–∂–Ω–æ, —Å–µ—Ä–≤–µ—Ä –≤–µ—Ä–Ω—É–ª HTML –≤–º–µ—Å—Ç–æ JSON`
- **–†–µ—à–µ–Ω–∏–µ**: 
  - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ URL –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç JSON
  - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å Content-Type

#### YAMLError
- **–ü—Ä–∏—á–∏–Ω–∞**: –ù–µ–≤–∞–ª–∏–¥–Ω—ã–π YAML –≤ OpenAPI —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏
- **–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å YAML —Ñ–∞–π–ª–∞

### 4. –§–∞–π–ª–æ–≤—ã–µ –æ—à–∏–±–∫–∏

#### FileNotFoundError
- **–ü—Ä–∏—á–∏–Ω–∞**: –õ–æ–∫–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω
- **–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É

#### PermissionError (üîí)
- **–ü—Ä–∏—á–∏–Ω–∞**: –ù–µ—Ç –ø—Ä–∞–≤ –Ω–∞ —á—Ç–µ–Ω–∏–µ —Ñ–∞–π–ª–∞
- **–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª—É

## –ú–µ—Ö–∞–Ω–∏–∑–º retry

–î–ª—è –≤—Å–µ—Ö –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫ (timeout, connection error, 5xx) –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è:
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫**: 3 (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `--max-retries`)
- **–ó–∞–¥–µ—Ä–∂–∫–∞**: –≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è (1—Å, 2—Å, 4—Å)
- **–ù–∞—Å—Ç—Ä–æ–π–∫–∞**: `--retry-delay` –¥–ª—è –±–∞–∑–æ–≤–æ–π –∑–∞–¥–µ—Ä–∂–∫–∏

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### –£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

- **ERROR**: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏, —Ç—Ä–µ–±—É—é—â–∏–µ –≤–Ω–∏–º–∞–Ω–∏—è
- **WARNING**: –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–∫–∞—Ö
- **INFO**: –£—Å–ø–µ—à–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è
- **DEBUG**: –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

### –§–æ—Ä–º–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏–π –æ–± –æ—à–∏–±–∫–∞—Ö

```
‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ {name}: {error_type}: {error_message}
‚è±Ô∏è Timeout –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫ {name}
üîå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: {details} –¥–ª—è {name}
üìù –û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON: {details} –¥–ª—è {name}
üîí –ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞: {details} –¥–ª—è {name}
```

## Health Check

–ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Ñ–∞–π–ª `health.json` —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º:

- **healthy**: –í—Å–µ URL –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã —É—Å–ø–µ—à–Ω–æ
- **degraded**: –ß–∞—Å—Ç—å URL –æ–±—Ä–∞–±–æ—Ç–∞–Ω–∞ —Å –æ—à–∏–±–∫–∞–º–∏
- **unhealthy**: –í—Å–µ URL –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã —Å –æ—à–∏–±–∫–∞–º–∏

## –ü—Ä–∏–º–µ—Ä—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏

### –ü—Ä–∏–º–µ—Ä 1: Timeout
```
2025-11-16 12:23:28 - WARNING - –ü–æ–ø—ã—Ç–∫–∞ 1 –Ω–µ—É–¥–∞—á–Ω–∞ –¥–ª—è TargetSMS API, –ø–æ–≤—Ç–æ—Ä —á–µ—Ä–µ–∑ 1.0—Å
2025-11-16 12:23:29 - WARNING - –ü–æ–ø—ã—Ç–∫–∞ 2 –Ω–µ—É–¥–∞—á–Ω–∞ –¥–ª—è TargetSMS API, –ø–æ–≤—Ç–æ—Ä —á–µ—Ä–µ–∑ 2.0—Å
2025-11-16 12:23:31 - ERROR - ‚è±Ô∏è Timeout –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫ TargetSMS API
```

### –ü—Ä–∏–º–µ—Ä 2: HTTP 403
```
2025-11-16 12:23:29 - ERROR - üîí HTTP –æ—à–∏–±–∫–∞ 403 –¥–ª—è Klientiks CRM API
```

### –ü—Ä–∏–º–µ—Ä 3: JSON Parse Error
```
2025-11-16 12:23:33 - ERROR - üìù –û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON: Expecting value: line 1 column 1 –¥–ª—è ForClasses API
```

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏**: –í—Å–µ –æ—à–∏–±–∫–∏ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ `api_watcher.log`
2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ health check**: `python main.py --health-check`
3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ retry**: –£–≤–µ–ª–∏—á—å—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫ –¥–ª—è –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö API
4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫
